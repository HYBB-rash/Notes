# 数据库E-R图分析

1.  车次信息：车次，类型（高铁，动车），起点，终点，发车时间，到达时间，运行时间
2.  站点信息：车次，站点序号，站点信息，到达时间，发车时间，里程（起点-本站点）
3.  座位信息：车次，车厢号，等级（一等座，二等座），座位号
4.  车票信息：车次，发车日期，车厢号，等级，空余座位号
5.  车票购买信息：车次，发车日期，起点站，终到站，车厢号，座位号，票价，身份证号，购买点，购买日期时间
6.  顾客信息：身份证号，姓名

## 需求分析

完成一个12306的数据库系统，需要满足以下几个功能：

1.  查询余票。
2.  预定车票。
3.  退订车票。
4.  修改车票的信息。
5.  购票人的实名认证。
6.  查询购票人已购的票的信息

### 查询余票

用户提供一个出发地，提供一个目的地，提供一个出发时间（精确到日），提供一个需要的类型。数据库返回当天所有的符合条件的车次。

用户提供的出发地和目的地，不一定是车次的起点和终点，而是车次的途径点。

返回的数据要有出发时间和到达时间，出发站和到达站，历时，各种类型的剩余座位。

### 预定车票

预定车票前，先实名认证。

认证完之后，选择车次，选择起点站，选择终点站，选择座位类型，选择座位，提交订单。

需要解决的问题就是：有可能座位是空着的，由于不是每个乘客都是从起点站一直坐做到终点站。（利用线段树算法解决）

### 退订车票

将用户的票设定为退订状态，然后恢复库存。

### 修改车票信息

暂时通过退订和重新预定来实现。

### 购票人信息

直接存进表中，身份证，姓名，性别

### 查看已购车票

输入身份证，查看自己名下的已购车票。

## 数据字典

车次：表示列车型号的ID

类型：列车的类型，分为高铁和动车。

起点站：列车的始发站

终点站：列车的终点站

发车时间：列车从始发站出发的时间。

到达时间：列车到达终点站的时间。

运行时间：列车整段路途的耗费时间。

身份证号：顾客的身份证号

姓名：顾客的姓名



